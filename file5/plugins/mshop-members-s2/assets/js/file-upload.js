!function(a){var b=void 0!==a("<input/>")[0].multiple,c=/msie/i.test(navigator.userAgent);a.fn.customFile=function(){return this.each(function(){var d=a(this).addClass("custom-file-upload-hidden"),e=a('<div class="file-upload-wrapper">'),f=a('<input type="text" class="file-upload-input" />'),g=a('<button type="button" class="file-upload-button">파일 선택</button>'),h=a('<label class="file-upload-button" for="'+d[0].id+'">파일 선택</label>'),i=a("ul.image-preview[name="+d.attr("name")+"]"),j=a("label.file-download");""!==a(this).attr("value")&&f.val(a(this).attr("value")).attr("title",a(this).attr("value")),d.css({position:"absolute",left:"-9999px"}),e.insertAfter(d).append(d,f,c?h:g),d.attr("tabIndex",-1),g.attr("tabIndex",-1),g.click(function(){d.focus().click()}),d.change(function(){i.html(""),j.html("");var c,e,g=[];if(b){c=d[0].files;for(var h=0,k=c.length;h<k;h++)g.push(c[h].name);e=g[0],1<g.length&&(e=g[0]+" 파일 외 "+(g.length-1)+"개")}else e=d.val().split("\\").pop();for(var h=0,k=c.length;h<k;h++)if(c[h].type.match("image/.*")){var l=c[h],m=new FileReader;m.fileName=l.name,m.onload=function(b){var c=a("<li></li>"),d=a("<img>");c.attr("data-title",b.target.fileName),d.attr("src",b.target.result),c.append(d),i.append(c)},m.readAsDataURL(l)}f.val(e).attr("title",e).focus()}),f.on({blur:function(){d.trigger("blur")},keydown:function(a){if(13===a.which)c||d.trigger("click");else{if(8!==a.which&&46!==a.which)return 9===a.which&&void 0;d.replaceWith(d=d.clone(!0)),d.trigger("change"),f.val("")}}})})},b||a(document).on("change","input.customfile",function(){var b=a(this),c="customfile_"+(new Date).getTime(),d=b.parent(),e=d.siblings().find(".file-upload-input").filter(function(){return!this.value}),f=a('<input type="file" id="'+c+'" name="'+b.attr("name")+'"/>');setTimeout(function(){b.val()?e.length||(d.after(f),f.customFile()):(e.parent().remove(),d.appendTo(d.parent()),d.find("input").focus())},1)})}(jQuery);