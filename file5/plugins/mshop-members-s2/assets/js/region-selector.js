jQuery(document).ready(function(a){var b={$sidoWrapper:null,$sigunguWrapper:null,$selectedRegionWrapper:null,sigunguInfo:{},selectedInfo:{},init:function(){this.$sidoWrapper=a("div.sido-wrapper"),this.$sigunguWrapper=a("div.sigungu-wrapper"),this.$selectedRegionWrapper=a("div.selected-region-wrapper"),this.bindEvent();var b=a("input[name="+_msm_region_selector.field_name+"]").val();_.isEmpty(b)||(this.selectedInfo=JSON.parse(b)),a(".sido:first-child",this.$sidoWrapper).trigger("click")},bindEvent:function(){a(".sido",b.$sidoWrapper).off("click").on("click",b.selectSido),a(".sigungu",b.$sigunguWrapper).off("click").on("click",b.selectSigungu),a(".region .delete",b.$selectedRegionWrapper).off("click").on("click",b.deleteSelectedRegion)},deleteSelectedRegion:function(){var c=a(this).closest("div.region"),d=c.data("sido"),e=c.data("sigungu");delete b.selectedInfo[d][e],a(".sido.selected",b.$sidoWrapper).trigger("click")},selectSido:function(){var c=a(this).data("sido");a(".sido",b.$sidoWrapper).removeClass("selected"),a(this).addClass("selected"),b.$sigunguWrapper.empty(),_.each(_msm_region_selector.regions[c],function(d,e){var f=wp.template("msm-sigungu-template"),g=!_.isUndefined(b.selectedInfo[c])&&!_.isUndefined(b.selectedInfo[c][e]),h=f({sido:c,sigungu:e,postcodes:d.join(","),class:g?"selected":""});h=h.replace("/*<![CDATA[*/",""),h=h.replace("/*]]>*/","");var i=a(h).clone();b.$sigunguWrapper.append(i)}),b.updateSigungu(),b.updateSelectedRegion()},updateSigungu:function(){a(".sigungu[data-postcodes=all]",b.$sigunguWrapper).hasClass("selected")&&(a(".sigungu",b.$sigunguWrapper).addClass("disabled"),a(".sigungu[data-postcodes=all]",b.$sigunguWrapper).removeClass("disabled"))},updateSelectedRegion:function(){b.$selectedRegionWrapper.empty(),_.each(b.selectedInfo,function(c,d){_.isEmpty(c)?delete b.selectedInfo[d]:_.each(c,function(c,e){var f=wp.template("msm-selected-region-template"),g=f({sido:d,sigungu:e,postcodes:c});g=g.replace("/*<![CDATA[*/",""),g=g.replace("/*]]>*/","");var h=a(g).clone();b.$selectedRegionWrapper.append(h)})}),b.bindEvent(),b.updateSido(),a("input[name="+_msm_region_selector.field_name+"]").val(_.isEmpty(b.selectedInfo)?"":JSON.stringify(b.selectedInfo))},selectSigungu:function(){var c=a(this).data("sido"),d=a(this).data("sigungu");a(this).hasClass("selected")?(delete b.selectedInfo[c][d],"전체"!==d&&"전국"!==d||a(".sigungu",b.$sigunguWrapper).removeClass("disabled"),a(this).removeClass("selected")):(_.isUndefined(b.selectedInfo[c])&&(b.selectedInfo[c]={}),"전체"!==d&&"전국"!==d||("전국"===c&&(b.selectedInfo={}),b.selectedInfo[c]={},a(".sigungu",b.$sigunguWrapper).removeClass("selected").addClass("disabled")),b.selectedInfo[c][d]=a(this).data("postcodes"),a(this).removeClass("disabled").addClass("selected")),b.updateSelectedRegion()},updateSido:function(){_.isUndefined(b.selectedInfo["전국"])?a(".sido",b.$sidoWrapper).removeClass("disabled"):(a(".sido",b.$sidoWrapper).addClass("disabled"),a(".sido[data-sido=전국]",b.$sidoWrapper).removeClass("disabled"))}};b.init()});