jQuery(document).ready(function($){$.fn.form.settings.rules.validatePasswordStrength=function(a){return 4===wp.passwordStrength.meter(a,wp.passwordStrength.userInputBlacklist())},$.fn.form.settings.rules.g_recaptcha_response=function(a){return 4===wp.passwordStrength.meter(a,wp.passwordStrength.userInputBlacklist())};var msfd_wrapper=[],msfd_steps=[],step_count=0,current_step=0,msfd_forms=[];msfd_forms=$("div.mfs_form"),msfd_forms.length>0&&$(msfd_forms[0]).fadeIn();var register_form=$(msfd_forms).find("[data-type=register]");msfd_wrapper=$("div.mfs_wrapper"),msfd_wrapper.length>0&&(msfd_steps=msfd_wrapper.find("div.mfs_item"),step_count=Math.min(msfd_steps.length,$(".ui.mfs_form").length),$(msfd_steps[0]).addClass("active"),msfd_wrapper.on("next",function(){if(current_step<step_count){var a=$(msfd_wrapper).offset();$(msfd_steps[current_step]).removeClass("active").addClass("completed"),$(msfd_forms[current_step++]).css("display","none"),$(msfd_steps[current_step]).addClass("active"),$(msfd_forms[current_step]).fadeIn(),$("html, body").animate({scrollTop:a.top})}}).on("prev",function(){current_step>0&&($(msfd_steps[current_step]).removeClass("active"),$(msfd_forms[current_step--]).css("display","none"),$(msfd_steps[current_step]).addClass("active").removeClass("completed"),$(msfd_forms[current_step]).fadeIn())}));var formController=function(){this.form=null,this.form_id="",this.index=0,this.count=0,this.form_args=null,this.form=null,this.message=null,this.initCertification=function(){if($(".mshop-ipin-certification",this.form).length>0||$(".mshop-checkplus-certification",this.form).length>0){var a=this,b=function(b,c,d){$("#mshop_auth_method",a.form).val(c),$("#mshop_auth_data",a.form).val(d),setTimeout(function(){alert("본인인증에 성공했습니다."),$(".ui.checkbox.user_certification",a.form).length>0?$(".ui.checkbox.user_certification",a.form).checkbox("set checked"):a.form.submit()})};$("body").on("MShopUserCertificationSuccess",b),$(".mshop-ipin-certification",this.form).unbind("click"),$(".mshop-ipin-certification",this.form).on("click",function(){document.form_ipin?(window.open("","popupIPIN2","width=450, height=550, top=100, left=100, fullscreen=no, menubar=no, status=no, toolbar=no, titlebar=yes, location=no, scrollbar=no"),document.form_ipin.target="popupIPIN2",document.form_ipin.action="https://cert.vno.co.kr/ipin.cb",document.form_ipin.submit()):alert("아이핀 인증정보를 확인할 수 없습니다.")}),$(".mshop-checkplus-certification",this.form).unbind("click"),$(".mshop-checkplus-certification",this.form).on("click",function(){document.form_chk?(window.open("","popupChk","width=500, height=550, top=100, left=100, fullscreen=no, menubar=no, status=no, toolbar=no, titlebar=yes, location=no, scrollbar=no"),document.form_chk.action="https://nice.checkplus.co.kr/CheckPlusSafeModel/checkplus.cb",document.form_chk.target="popupChk",document.form_chk.submit()):alert("아이핀 인증정보를 확인할 수 없습니다.")})}},this.initAgreement=function(){if($(".checkbox.agree_all",this.form).length>0||$(".agreement-item",this.form).length>0){var a=this;$(".checkbox.agree_all",this.form).checkbox({onChecked:function(){setTimeout(function(){$(".ui.checkbox.agreement-item",a.form).checkbox("set checked")},100)},onUnchecked:function(){setTimeout(function(){$(".ui.checkbox.agreement-item",a.form).checkbox("set unchecked")},100)}}),$(".ui.checkbox.agreement-item",this.form).checkbox({onChecked:function(b){$(".ui.checkbox.agreement-item input[type=checkbox]",a.form).length===$(".ui.checkbox.agreement-item input[type=checkbox]:checked",a.form).length&&$(".checkbox.agree_all",a.form).checkbox("set checked"),b=b||window.event,b.cancelBubble=!0},onUnchecked:function(b){$(".checkbox.agree_all",a.form).checkbox("set unchecked"),b=b||window.event,b.cancelBubble=!0}}),$("div.accordion",this.form).accordion({animateChildren:!1,duration:0})}},this.initLostPassword=function(){var a=function(){var a=this;$(a.message).empty(),$(this.form).addClass("loading"),$.ajax({url:this.form_args.ajaxurl,type:"POST",data:"action="+_msm.slug+"_mshop_members_lostpassword&"+$(this.form).serialize(),success:function(b){b.success?($(a.message).append('<div class="ui small positive message">'+b.data+"</div>"),$(a.form).removeClass("loading")):($(a.message).append('<div class="ui small negative message">'+b.data+"</div>"),$(a.form).removeClass("loading"))}})}.bind(this);$(this.form).form({onSuccess:a,fields:JSON.parse(this.form_args.fieldRules)}),$(".ui.button.find-password",self.form).on("click",function(a){this.validateForm()}.bind(this)),$(this.form).find("input[type=text]")[0].focus()},this.initSubmitForm=function(){var a=function(a,b){"function"==typeof lf_global_msg_popup?lf_global_msg_popup($.unique(a).join("<br>")):alert($.unique(a).join())},b=function(){if($("body").trigger("msm-before-submit"),this.index<this.count)$(msfd_wrapper).trigger("next");else{var a=this,b="",c=[],d={};d.action=_msm.slug+"_submit",$.each($("div.mfs_form form"),function(a,e){var f=$(e).data("id"),g=$(e).serialize();b+="&form_"+f+"="+encodeURI(g),c.push(f),d["form_"+f]=encodeURI(g)}),d.form_ids=c.join(","),d.msm_nonce=this.form_args.msm_nonce,$(a.message).empty(),$(this.form).addClass("loading"),$.ajax({url:this.form_args.ajaxurl,type:"POST",data:d,dataType:"json",success:function(b){b.success?b.data&&(b.data._msm_postid&&$("input[name=_msm_postid]",this.form).val(b.data._msm_postid),b.data.message&&$(a.message).append('<div class="ui small positive message">'+b.data.message+"</div>"),void 0!==b.data.redirect_url?""===b.data.redirect_url?window.location=window.location.href:window.location.replace(b.data.redirect_url):void 0!==b.data.trigger?$("body").trigger(b.data.trigger,a):$(a.form).removeClass("loading")):($(a.message).append('<div class="ui small negative message">'+b.data+"</div>"),$(a.form).removeClass("loading"))}})}}.bind(this);this.error_popup?$(this.form).form({onSuccess:b,onFailure:a,fields:JSON.parse(this.form_args.fieldRules)}):$(this.form).form({onSuccess:b,fields:JSON.parse(this.form_args.fieldRules)}),$(this.form).find("input[type=text]").length>0&&$(this.form).find("input[type=text]")[0].focus()},this.initWritePostForm=function(){var a=function(){if(this.index<this.count)$(msfd_wrapper).trigger("next");else{var a=this,b="",c=[],d={};d.action=_msm.slug+"_submit",$.each($("div.mfs_form form"),function(a,e){var f=$(e).data("id"),g=$(e).serialize();b+="&form_"+f+"="+encodeURI(g),c.push(f),d["form_"+f]=encodeURI(g)}),d.form_ids=c.join(","),d.msm_nonce=this.form_args.msm_nonce,$(a.message).empty(),$(this.form).addClass("loading"),$.ajax({url:this.form_args.ajaxurl,type:"POST",data:d,dataType:"json",success:function(b){b.success?b.data&&(b.data.message&&$(a.message).append('<div class="ui small positive message">'+b.data.message+"</div>"),void 0!==b.data.redirect_url?""===b.data.redirect_url?window.location=window.location.href:window.location.replace(b.data.redirect_url):$(a.form).removeClass("loading")):($(a.message).append('<div class="ui small negative message">'+b.data+"</div>"),$(a.form).removeClass("loading"))}})}}.bind(this);$(this.form).form({onSuccess:a,fields:JSON.parse(this.form_args.fieldRules)}),$(this.form).find("input[type=text]").length>0&&$(this.form).find("input[type=text]")[0].focus()},this.init=function(count,index,msfd_form){if(this.count=count,this.index=index,this.form=$(msfd_form).find(".ui.form"),this.form_id=$(this.form).data("id"),this.form_type=$(this.form).data("type"),this.error_popup="yes"===$(this.form).data("error_popup"),this.message=$(msfd_form).find(".mshop-members-message"),this.form_args=eval("mfs_form_"+this.form_id),$(".ui.checkbox",this.form).checkbox(),!1!==$("div.mfs_form").triggerHandler("msm-form-"+this.form_type,this)){switch(this.form_type){case"find-password":this.initLostPassword();break;default:this.initAgreement(),this.initSubmitForm()}this.form.trigger("msm-form-controller-init",this)}}};$.each(msfd_forms,function(a,b){(new formController).init(step_count,a+1,b)}),$("body").on("msm_initialize_form",function(a,b){(new formController).init(0,1,$(b))})});